<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Postprocessing · VoronoiFVM.jl</title><meta name="title" content="Postprocessing · VoronoiFVM.jl"/><meta property="og:title" content="Postprocessing · VoronoiFVM.jl"/><meta property="twitter:title" content="Postprocessing · VoronoiFVM.jl"/><meta name="description" content="Documentation for VoronoiFVM.jl."/><meta property="og:description" content="Documentation for VoronoiFVM.jl."/><meta property="twitter:description" content="Documentation for VoronoiFVM.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">VoronoiFVM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../changes/">Changelog</a></li><li><a class="tocitem" href="../method/">The Voronoi finite volume method</a></li><li><span class="tocitem">API Documentation</span><ul><li><a class="tocitem" href="../system/">System</a></li><li><a class="tocitem" href="../physics/">Physics &amp; special functions</a></li><li><a class="tocitem" href="../solutions/">Solution objects</a></li><li><a class="tocitem" href="../solver/">Solvers</a></li><li class="is-active"><a class="tocitem" href>Postprocessing</a><ul class="internal"><li><a class="tocitem" href="#Plotting"><span>Plotting</span></a></li><li><a class="tocitem" href="#Grid-verification"><span>Grid verification</span></a></li><li><a class="tocitem" href="#Norms-and-volumes"><span>Norms &amp; volumes</span></a></li><li><a class="tocitem" href="#Solution-integrals"><span>Solution integrals</span></a></li><li><a class="tocitem" href="#Boundary-fluxes"><span>Boundary fluxes</span></a></li><li><a class="tocitem" href="#Nodal-flux-reconstruction"><span>Nodal flux reconstruction</span></a></li><li><a class="tocitem" href="#Impedance-calculatiom"><span>Impedance calculatiom</span></a></li></ul></li><li><a class="tocitem" href="../quantities/">Quantities</a></li><li><a class="tocitem" href="../misc/">Miscellaneous</a></li><li><a class="tocitem" href="../internal/">Internal API</a></li><li><a class="tocitem" href="../allindex/">Index</a></li><li><a class="tocitem" href="../extensions/"><code>ExtendableFEMBase</code> Extension</a></li><li><a class="tocitem" href="../devel/">Development hints</a></li></ul></li><li><span class="tocitem">Tutorial Notebooks</span><ul><li><a class="tocitem" href="../notebooks/">About the notebooks</a></li><li><a class="tocitem" href="../plutostatichtml_examples/ode-diffusion1d/">OrdinaryDiffEq.jl nonlinear diffusion</a></li><li><a class="tocitem" href="../plutostatichtml_examples/ode-wave1d/">OrdinaryDiffEq.jl 1D wave equation</a></li><li><a class="tocitem" href="../plutostatichtml_examples/ode-nlstorage1d/">OrdinaryDiffEq.jl changing mass matrix</a></li><li><a class="tocitem" href="../plutostatichtml_examples/ode-brusselator/">OrdinaryDiffEq.jl brusselator</a></li><li><a class="tocitem" href="../plutostatichtml_examples/heterogeneous-catalysis/">Coupling with Catalyst.jl</a></li><li><a class="tocitem" href="../plutostatichtml_examples/outflow/">Outflow boundary conditions</a></li><li><a class="tocitem" href="../plutostatichtml_examples/flux-reconstruction/">Obtaining vector fields</a></li><li><a class="tocitem" href="../plutostatichtml_examples/interfaces1d/">Internal interfaces (1D)</a></li><li><a class="tocitem" href="../plutostatichtml_examples/problemcase/">A case for caution</a></li><li><a class="tocitem" href="../plutostatichtml_examples/nonlinear-solvers/">Nonlinear solver control</a></li><li><a class="tocitem" href="../plutostatichtml_examples/bernoulli/">Bernoulli function test</a></li><li><a class="tocitem" href="../plutostatichtml_examples/api-update/">API Updates</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../runexamples/">About the examples</a></li><li><a class="tocitem" href="../module_examples/Example101_Laplace1D/">101: 1D Laplace equation</a></li><li><a class="tocitem" href="../module_examples/Example102_StationaryConvectionDiffusion1D/">102: 1D Stationary convection-diffusion equation</a></li><li><a class="tocitem" href="../module_examples/Example103_ConvectionDiffusion1D/">103: 1D Transient convection-diffusion equation</a></li><li><a class="tocitem" href="../module_examples/Example105_NonlinearPoisson1D/">105: 1D Nonlinear Poisson equation</a></li><li><a class="tocitem" href="../module_examples/Example106_NonlinearDiffusion1D/">106: 1D Nonlinear Diffusion equation</a></li><li><a class="tocitem" href="../module_examples/Example107_NonlinearStorage1D/">107: 1D Nonlinear Storage</a></li><li><a class="tocitem" href="../module_examples/Example108_OrdinaryDiffEq1D/">108: 1D Nonlinear Diffusion equation with Rosenbrock method</a></li><li><a class="tocitem" href="../module_examples/Example110_ReactionDiffusion1D_TwoSpecies/">110: 1D Reaction Diffusion equation with two species</a></li><li><a class="tocitem" href="../module_examples/Example115_HeterogeneousCatalysis1D/">115: 1D heterogeneous catalysis</a></li><li><a class="tocitem" href="../module_examples/Example120_ThreeRegions1D/">120: Differing Species Sets in Three Regions, 1D</a></li><li><a class="tocitem" href="../module_examples/Example121_PoissonPointCharge1D/">121: 1D Poisson Equation with Point Charge</a></li><li><a class="tocitem" href="../module_examples/Example125_TestFunctions1D/">125: Terminal Flux Calculation via Test Functions, 1D</a></li><li><a class="tocitem" href="../module_examples/Example150_Impedance1D/">150: Impedance calculation</a></li><li><a class="tocitem" href="../module_examples/Example151_Impedance1D/">151: Impedance calculation</a></li><li><a class="tocitem" href="../module_examples/Example160_UnipolarDriftDiffusion1D/">160: Unipolar degenerate drift-diffusion</a></li><li><a class="tocitem" href="../module_examples/Example161_BipolarDriftDiffusionCurrent/">161: Bipolar drift-diffusion with different definition of current</a></li><li><a class="tocitem" href="../module_examples/Example201_Laplace2D/">201: 2D Laplace equation</a></li><li><a class="tocitem" href="../module_examples/Example203_CoordinateSystems/">203: Various coordinate systems</a></li><li><a class="tocitem" href="../module_examples/Example204_HagenPoiseuille/">204: 2D Convection in Hagen-Poiseuille flow</a></li><li><a class="tocitem" href="../module_examples/Example205_StagnationPoint/">205: Convection in axisymmetric stagnation point flow</a></li><li><a class="tocitem" href="../module_examples/Example206_JouleHeat/">206: 2D Joule heating</a></li><li><a class="tocitem" href="../module_examples/Example207_NonlinearPoisson2D/">207: 2D Nonlinear Poisson equation</a></li><li><a class="tocitem" href="../module_examples/Example210_NonlinearPoisson2D_Reaction/">210: 2D Nonlinear Poisson with reaction</a></li><li><a class="tocitem" href="../module_examples/Example215_NonlinearPoisson2D_BoundaryReaction/">215: 2D Nonlinear Poisson with boundary reaction</a></li><li><a class="tocitem" href="../module_examples/Example220_NonlinearPoisson2D_BoundarySpecies/">220: 2D Nonlinear Poisson with boundary reaction and boundary species</a></li><li><a class="tocitem" href="../module_examples/Example221_EquationBlockPrecon/">221: Equation block preconditioning</a></li><li><a class="tocitem" href="../module_examples/Example225_TestFunctions2D/">225: Terminal flux calculation via test functions, nD</a></li><li><a class="tocitem" href="../module_examples/Example226_BoundaryIntegral/">226: Terminal flux calculation via test functions, nD, boundary reaction</a></li><li><a class="tocitem" href="../module_examples/Example230_BoundaryFlux/">103: Boundary flux</a></li><li><a class="tocitem" href="../module_examples/Example301_Laplace3D/">301: 3D Laplace equation</a></li><li><a class="tocitem" href="../module_examples/Example311_HeatEquation_BoundaryDiffusion/">311: Heat Equation with boundary diffusion</a></li><li><a class="tocitem" href="../module_examples/Example405_GenericOperator/">405: Generic operator</a></li><li><a class="tocitem" href="../module_examples/Example406_WeirdReaction/">406: 1D Weird Surface Reaction</a></li><li><a class="tocitem" href="../module_examples/Example410_ManySpecies/">410: Many Species</a></li><li><a class="tocitem" href="../module_examples/Example420_DiscontinuousQuantities/">420: Discontinuous Quantities</a></li><li><a class="tocitem" href="../module_examples/Example421_AbstractQuantities_TestFunctions/">421: Current Calculation for AbstractQuantities</a></li><li><a class="tocitem" href="../module_examples/Example422_InterfaceQuantities/">422: Drift-Diffusion with Discontinuous and Interface Potentials</a></li><li><a class="tocitem" href="../module_examples/Example424_AbstractQuantitiesInit/">424: Initialization of Abstract quantities</a></li><li><a class="tocitem" href="../module_examples/Example430_ParameterDerivativesStationary/">430: Parameter Derivatives (stationary)</a></li><li><a class="tocitem" href="../module_examples/Example435_HigherPrecision/">434: Higher precision</a></li><li><a class="tocitem" href="../module_examples/Example440_ParallelState/">440: Parallel solves</a></li></ul></li><li><span class="tocitem">Development Examples</span><ul><li><a class="tocitem" href="../module_examples/DevEx001_Solvers/">001: Legacy API for linear solvers</a></li><li><a class="tocitem" href="../module_examples/DevEx002_EdgeReaction/">002: check edge reaction</a></li><li><a class="tocitem" href="../module_examples/DevEx003_Solvers/">003: New linear solver API</a></li><li><a class="tocitem" href="../module_examples/DevEx004_EquationBlock3D/">004: 3D Nonlinear Reaction-Diffusion System with Coupled Species</a></li><li><a class="tocitem" href="../module_examples/DevEx005_Mixture/">005: Mixture</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Documentation</a></li><li class="is-active"><a href>Postprocessing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Postprocessing</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/master/docs/src/post.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Postprocessing"><a class="docs-heading-anchor" href="#Postprocessing">Postprocessing</a><a id="Postprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#Postprocessing" title="Permalink"></a></h1><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><p>Plotting can be performed using the package <a href="https://github.com/WIAS-PDELib/GridVisualize.jl">GridVisualize.jl</a>. This package extends the API with a couple of methods for systems:</p><article><details class="docstring" open="true"><summary id="GridVisualize.gridplot"><a class="docstring-binding" href="#GridVisualize.gridplot"><code>GridVisualize.gridplot</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">gridplot(sys::VoronoiFVM.AbstractSystem; kwargs...) -&gt; Any
</code></pre><p>Plot grid behind system</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/gridvisualize.jl#L1-L5">source</a></div></details></article><article><details class="docstring" open="true"><summary id="GridVisualize.gridplot!"><a class="docstring-binding" href="#GridVisualize.gridplot!"><code>GridVisualize.gridplot!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">gridplot!(
    vis,
    sys::VoronoiFVM.AbstractSystem;
    kwargs...
) -&gt; Any
</code></pre><p>Plot grid behind system</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/gridvisualize.jl#L8-L12">source</a></div></details></article><article><details class="docstring" open="true"><summary id="GridVisualize.scalarplot"><a class="docstring-binding" href="#GridVisualize.scalarplot"><code>GridVisualize.scalarplot</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">scalarplot(
    sys::VoronoiFVM.AbstractSystem,
    sol::AbstractMatrix;
    species,
    scale,
    kwargs...
) -&gt; Any
</code></pre><p>Plot one species from solution</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/gridvisualize.jl#L15-L19">source</a></div><div><pre><code class="language-julia hljs">scalarplot(
    sys::VoronoiFVM.AbstractSystem,
    sol::VoronoiFVM.AbstractTransientSolution;
    species,
    scale,
    tscale,
    kwargs...
) -&gt; Any
</code></pre><p>Plot one species from transient solution</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/gridvisualize.jl#L33-L37">source</a></div></details></article><article><details class="docstring" open="true"><summary id="GridVisualize.scalarplot!"><a class="docstring-binding" href="#GridVisualize.scalarplot!"><code>GridVisualize.scalarplot!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">scalarplot!(
    vis,
    sys::VoronoiFVM.AbstractSystem,
    sol::AbstractMatrix;
    species,
    scale,
    kwargs...
) -&gt; Any
</code></pre><p>Plot one species from solution</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/gridvisualize.jl#L24-L28">source</a></div><div><pre><code class="language-julia hljs">scalarplot!(
    vis,
    sys::VoronoiFVM.AbstractSystem,
    sol::VoronoiFVM.AbstractTransientSolution;
    species,
    scale,
    tscale,
    tlabel,
    kwargs...
) -&gt; Any
</code></pre><p>Plot one species from transient solution</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/gridvisualize.jl#L49-L53">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.plothistory"><a class="docstring-binding" href="#VoronoiFVM.plothistory"><code>VoronoiFVM.plothistory</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">plothistory(tsol; 
            plots=[:timestepsizes,
                   :timestepupdates,
                   :newtonsteps,
                   :newtonupdates], 
            size=(700,600), 
            logmin=1.0e-20,
            Plotter=GridVisualize.default_plotter(),
            kwargs...)</code></pre><p>Plot solution history stored in <code>tsol</code>. The <code>plots</code> argument allows to choose which plots are shown.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/gridvisualize.jl#L82-L94">source</a></div></details></article><h2 id="Grid-verification"><a class="docs-heading-anchor" href="#Grid-verification">Grid verification</a><a id="Grid-verification-1"></a><a class="docs-heading-anchor-permalink" href="#Grid-verification" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM.nondelaunay"><a class="docstring-binding" href="#VoronoiFVM.nondelaunay"><code>VoronoiFVM.nondelaunay</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">nondelaunay(grid;tol=1.0e-14, verbose=true)</code></pre><p>Return non-Delaunay edges. Returns a vector of tuples: Each tuple consists of <code>(node1, node2, edge factor, region)</code></p><p>If the vector has length 0, the grid is boundary conforming Delaunay with respect to each cell region. This means that up to <code>tol</code>, all edge form factors are nonnegative.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L404-L413">source</a></div></details></article><h2 id="Norms-and-volumes"><a class="docs-heading-anchor" href="#Norms-and-volumes">Norms &amp; volumes</a><a id="Norms-and-volumes-1"></a><a class="docs-heading-anchor-permalink" href="#Norms-and-volumes" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="LinearAlgebra.norm"><a class="docstring-binding" href="#LinearAlgebra.norm"><code>LinearAlgebra.norm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">norm(system, u)
norm(system, u, p)
</code></pre><p>Calculate Euklidean norm of the degree of freedom vector.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L249-L253">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.lpnorm"><a class="docstring-binding" href="#VoronoiFVM.lpnorm"><code>VoronoiFVM.lpnorm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">lpnorm(sys, u, p)
lpnorm(sys, u, p, species_weights)
</code></pre><p>Calculate weighted discrete <span>$L^p$</span> norm of a solution vector.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L264-L268">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.l2norm"><a class="docstring-binding" href="#VoronoiFVM.l2norm"><code>VoronoiFVM.l2norm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">l2norm(sys, u)
l2norm(sys, u, species_weights)
</code></pre><p>Calculate weighted discrete <span>$L^2(\Omega)$</span> norm of a solution vector.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L276-L280">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.w1pseminorm"><a class="docstring-binding" href="#VoronoiFVM.w1pseminorm"><code>VoronoiFVM.w1pseminorm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">w1pseminorm(sys, u, p)
w1pseminorm(sys, u, p, species_weights)
</code></pre><p>Calculate weighted discrete <span>$W^{1,p}(\Omega)$</span> seminorm of a solution vector.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L286-L290">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.h1seminorm"><a class="docstring-binding" href="#VoronoiFVM.h1seminorm"><code>VoronoiFVM.h1seminorm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">h1seminorm(sys, u)
h1seminorm(sys, u, species_weights)
</code></pre><p>Calculate weighted discrete <span>$H^1(\Omega)$</span> seminorm of a solution vector.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L306-L310">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.w1pnorm"><a class="docstring-binding" href="#VoronoiFVM.w1pnorm"><code>VoronoiFVM.w1pnorm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">w1pnorm(sys, u, p)
w1pnorm(sys, u, p, species_weights)
</code></pre><p>Calculate weighted discrete <span>$W^{1,p}(\Omega)$</span> norm of a solution vector.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L316-L320">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.h1norm"><a class="docstring-binding" href="#VoronoiFVM.h1norm"><code>VoronoiFVM.h1norm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">h1norm(sys, u)
h1norm(sys, u, species_weights)
</code></pre><p>Calculate weighted discrete <span>$H^1(\Omega)$</span> norm of a solution vector.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L326-L330">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.lpw1pseminorm"><a class="docstring-binding" href="#VoronoiFVM.lpw1pseminorm"><code>VoronoiFVM.lpw1pseminorm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">lpw1pseminorm(sys, u, p)
lpw1pseminorm(sys, u, p, species_weights)
</code></pre><p>Calculate weighted discrete <span>$L^p([0,T];W^{1,p}(\Omega))$</span> seminorm of a transient solution.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L356-L360">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.l2h1seminorm"><a class="docstring-binding" href="#VoronoiFVM.l2h1seminorm"><code>VoronoiFVM.l2h1seminorm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">l2h1seminorm(sys, u)
l2h1seminorm(sys, u, species_weights)
</code></pre><p>Calculate weighted discrete <span>$L^2([0,T];H^1(\Omega))$</span> seminorm of a transient solution.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L365-L369">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.lpw1pnorm"><a class="docstring-binding" href="#VoronoiFVM.lpw1pnorm"><code>VoronoiFVM.lpw1pnorm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">lpw1pnorm(sys, u, p)
lpw1pnorm(sys, u, p, species_weights)
</code></pre><p>Calculate weighted discrete <span>$L^p([0,T];W^{1,p}(\Omega))$</span> norm of a transient solution.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L347-L351">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.l2h1norm"><a class="docstring-binding" href="#VoronoiFVM.l2h1norm"><code>VoronoiFVM.l2h1norm</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">l2h1norm(sys, u)
l2h1norm(sys, u, species_weights)
</code></pre><p>Calculate weighted discrete <span>$L^2([0,T];H^1(\Omega))$</span> norm of a transient solution.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L374-L378">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.nodevolumes"><a class="docstring-binding" href="#VoronoiFVM.nodevolumes"><code>VoronoiFVM.nodevolumes</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">nodevolumes(system)
</code></pre><p>Calculate volumes of Voronoi cells.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L383-L387">source</a></div></details></article><h2 id="Solution-integrals"><a class="docs-heading-anchor" href="#Solution-integrals">Solution integrals</a><a id="Solution-integrals-1"></a><a class="docs-heading-anchor-permalink" href="#Solution-integrals" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate-Union{Tuple{Tu}, Tuple{VoronoiFVM.AbstractSystem, Any, AbstractMatrix{Tu}}} where Tu"><a class="docstring-binding" href="#VoronoiFVM.integrate-Union{Tuple{Tu}, Tuple{VoronoiFVM.AbstractSystem, Any, AbstractMatrix{Tu}}} where Tu"><code>VoronoiFVM.integrate</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">integrate(system,F,U; boundary=false, data=system.physics.data)</code></pre><p>Integrate node function (same signature as reaction or storage)  <code>F</code> of  solution vector <code>U</code> region-wise over domain or boundary. The result is an <code>nspec x nregion</code> matrix <span>$\int_{\Omega_j} F_i(U)\, dx$</span> or <span>$\int_{\Gamma_j} F_i(U)\, ds$</span>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L10-L17">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate-Tuple{VoronoiFVM.AbstractSystem, Any, VoronoiFVM.AbstractTransientSolution}"><a class="docstring-binding" href="#VoronoiFVM.integrate-Tuple{VoronoiFVM.AbstractSystem, Any, VoronoiFVM.AbstractTransientSolution}"><code>VoronoiFVM.integrate</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">integrate(system,F, Ut; boundary=false, data=system.physics.data)</code></pre><p>Integrate transient solution vector region-wise over domain or boundary. The result is an <code>nspec x nregion x nsteps</code> DiffEqArray <span>$\int_{\Omega_j} F_i(U_k)\, dx$</span> or <span>$\int_{\Gamma_j} F_i(U_k)\, ds$</span>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L69-L75">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate-Tuple{VoronoiFVM.AbstractSystem, AbstractMatrix}"><a class="docstring-binding" href="#VoronoiFVM.integrate-Tuple{VoronoiFVM.AbstractSystem, AbstractMatrix}"><code>VoronoiFVM.integrate</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">integrate(system,U; boundary=false)</code></pre><p>Integrate solution vector region-wise over domain or boundary. The result is an <code>nspec x nregion</code> matrix <span>$\int_{\Omega_j} U_i\, dx$</span> or <span>$\int_{\Gamma_j} U_i\, ds$</span>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L87-L93">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.edgeintegrate"><a class="docstring-binding" href="#VoronoiFVM.edgeintegrate"><code>VoronoiFVM.edgeintegrate</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">edgeintegrate(system,F,U; boundary=false)</code></pre><p>Integrate edge function (same signature as flux function)  <code>F</code> of  solution vector region-wise over domain or boundary. The result is an <code>nspec x nregion</code> matrix.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L102-L108">source</a></div></details></article><h2 id="Boundary-fluxes"><a class="docs-heading-anchor" href="#Boundary-fluxes">Boundary fluxes</a><a id="Boundary-fluxes-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-fluxes" title="Permalink"></a></h2><h3 id="Continuum-level-motivation"><a class="docs-heading-anchor" href="#Continuum-level-motivation">Continuum level motivation</a><a id="Continuum-level-motivation-1"></a><a class="docs-heading-anchor-permalink" href="#Continuum-level-motivation" title="Permalink"></a></h3><p>For  the calculation  of boundary  fluxes, we  use a method inspired by H. Gajewski, WIAS Report No 6, 1993: &quot;The regularity of the (weak) solutions of the drift-diffusion equations, which are guaranteed by existence statements, is not sufficient to justify a naive calculation of the currents as boundary integrals.  Rather, it has also proven to be practical and necessary to reduce contact currents to volume integrals in accordance with the definition of weak solutions using suitable test functions.&quot;</p><p>We start with  the  continuous  case for a problem</p><p class="math-container">\[    \partial_t s(u) + \nabla\cdot \vec j(u)  + r(u) - f  =0
\]</p><p>defined in a domain <span>$\Omega$</span> with a boundary <span>$Γ=⋃_{i\in B}Γ_i$</span> subdivided into non-overlapping parts where the set of boundary regions <span>$B$</span> is subdivided into <span>$B=B_N\cup B_0 \cup B_1$</span>. Assume that <span>$\vec  j\cdot \vec n=0$</span> on  <span>$\Gamma_i$</span> for <span>$i\in B_N$</span>.</p><p>Let  <span>$T(x)$</span> be  a smooth test function  such that</p><ul><li><span>$\nabla  T \cdot  \vec  n|_{Γ_i}=  0$</span> for <span>$i\in B_N$</span>,</li><li><span>$T|_{Γ_i} = 0$</span> for  <span>$i\in B_0$</span>,</li><li><span>$T|_{Γ_i} = 1$</span> for  <span>$i\in B_1$</span>.</li></ul><p>Here, we obtain it by solving the Laplace equation </p><p class="math-container">\[   -\Delta T =0 \quad \text{in}\; \Omega\]</p><p>To obtain as a quantity of interest the  flux <span>$Q$</span> through the boundaries <span>$\Gamma_i$</span> for <span>$i\in B_1$</span> of, calculate:</p><p class="math-container">\[  \begin{aligned}
    Q=Q(t)&amp;=\sum_{i \in B_1}\int\limits_{\Gamma_i} T\vec j(u)\cdot\vec n \,d\gamma\\
    &amp;=\sum_{i \in B_1}\int\limits_{\Gamma_i} T\vec j(u)\cdot\vec n \,d\gamma 
      + \sum_{i \in B_N}\int\limits_{\Gamma_i} T\vec j(u)\cdot\vec n \,d\gamma 
      + \sum_{i \in B_0}\int\limits_{\Gamma_l} T\vec j(u)\cdot\vec n \,d\gamma\\
    &amp;=\int\limits_{\Gamma} T\vec j(u)\cdot\vec n \,d\gamma\\
    &amp;=\int\limits_{\Omega}\nabla\cdot(T\vec j(u))\,d\omega\\
    &amp;=\int\limits_{\Omega}\nabla T \cdot \vec{j(u)} \,d\omega + \int\limits_{\Omega}T \nabla\cdot \vec{j(u)} \,d\omega\\
    &amp;=\int\limits_{\Omega}\nabla T \cdot \vec{j}(u) \,d\omega - \int\limits_{\Omega}T r(u) \,d\omega +  \int\limits_{\Omega}T f \,d\omega - \int\limits_{\Omega}T \partial_ts(u) \,d\omega
  \end{aligned}\]</p><h3 id="discrete_appr"><a class="docs-heading-anchor" href="#discrete_appr">Discrete approximations of the integrals</a><a id="discrete_appr-1"></a><a class="docs-heading-anchor-permalink" href="#discrete_appr" title="Permalink"></a></h3><p>The discete versions of these integrals for evaluation at <span>$t=t^n$</span> are as follows:</p><p class="math-container">\[  \begin{aligned}
    \int\limits_{\Omega}T r(u) \,d\omega &amp;\approx \sum_{k\in N} T_kr(u^n_k)|\omega_k| =: I_{func}(r, T,u^n)\\
    \int\limits_{\Omega}T f \,d\omega &amp;\approx \sum_{k\in N} T_k f_k|\omega_k| =: I_{src}(f, T)\\
    \int\limits_{\Omega}T \partial_ts(u) \,d\omega &amp;\approx \frac{ I_{func}(s,T,u^n) -I_{func}(s,T,u^{n-1})}{t^n-t^{n-1}}\\
    \int\limits_{\Omega}\nabla T \cdot \vec{j}(u^n) d\omega &amp;\approx
    \sum\limits_{\stackrel{k,l}{\partial \omega_k \cup \partial \omega_l\neq\emptyset}} (T_{k}-T_{l})\frac{\sigma_{kl}}{h_{kl}}g(u^n_k, u^n_l) =: I_{flux}(j,T,u)
  \end{aligned}\]</p><h3 id="General-flux-calculation-API"><a class="docs-heading-anchor" href="#General-flux-calculation-API">General flux calculation API</a><a id="General-flux-calculation-API-1"></a><a class="docs-heading-anchor-permalink" href="#General-flux-calculation-API" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="VoronoiFVM.TestFunctionFactory"><a class="docstring-binding" href="#VoronoiFVM.TestFunctionFactory"><code>VoronoiFVM.TestFunctionFactory</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">mutable struct TestFunctionFactory{Tu, Tv}</code></pre><p>Data structure containing DenseSystem used to calculate test functions for boundary flux calculations.</p><p>Type parameters:</p><ul><li><code>Tu</code>: value type of test functions</li><li><code>Tv</code>: Default value type of system</li></ul><p>Fields:</p><ul><li><code>system::VoronoiFVM.AbstractSystem{Tv} where Tv</code>: Original system</li></ul><ul><li><code>state::VoronoiFVM.SystemState{Tu, Tp, TMatrix, TGenericMatrix, TSolArray} where {Tu, Tp, TMatrix&lt;:AbstractMatrix{Tu}, TGenericMatrix, TSolArray&lt;:AbstractMatrix{Tu}}</code>: Test function system state</li></ul><ul><li><code>control::SolverControl</code>: Solver control</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L2">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.TestFunctionFactory-Tuple{VoronoiFVM.AbstractSystem}"><a class="docstring-binding" href="#VoronoiFVM.TestFunctionFactory-Tuple{VoronoiFVM.AbstractSystem}"><code>VoronoiFVM.TestFunctionFactory</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">TestFunctionFactory(system; control= SolverControl())</code></pre><p>Constructor for TestFunctionFactory from system.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L33-L37">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.testfunction"><a class="docstring-binding" href="#VoronoiFVM.testfunction"><code>VoronoiFVM.testfunction</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">testfunction(factory::TestFunctionFactory, B_0, B_1)</code></pre><p>Create a test function <span>$T$</span> defined in the domain <span>$Ω$</span> given by the system behind the factory object. Assume  that the  boundary <span>$Γ=∂Ω=⋃_{i∈ B}Γ_i$</span> is subdivided into non-overlapping parts where the set of boundary regions <span>$B$</span> is subdivided into <span>$B=B_N∪ B_0 ∪ B_1$</span>. Create <span>$T$</span> by solving</p><p class="math-container">\[   -Δ T =0 \quad \text{in}\; Ω\]</p><p>such that</p><ul><li><span>$∇  T ⋅  \vec n|_{Γ_i}=  0$</span> for <span>$i∈ B_N$</span></li><li><span>$T|_{Γ_i} = 0$</span> for  <span>$i∈ B_0$</span>,</li><li><span>$T|_{Γ_i} = 1$</span> for  <span>$i∈ B_1$</span>.</li></ul><p>Returns a vector representing T.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L54-L70">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate-Union{Tuple{Tv}, Tuple{Tu}, Tuple{VoronoiFVM.AbstractSystem, Vector{Tv}, AbstractMatrix{Tu}}} where {Tu, Tv}"><a class="docstring-binding" href="#VoronoiFVM.integrate-Union{Tuple{Tv}, Tuple{Tu}, Tuple{VoronoiFVM.AbstractSystem, Vector{Tv}, AbstractMatrix{Tu}}} where {Tu, Tv}"><code>VoronoiFVM.integrate</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs"> integrate(system, T, U::AbstractMatrix)</code></pre><p>Calculate test function integral for a steady state solution <span>$u$</span>   <span>$∫_Γ T \vec j(u) ⋅ \vec n dω ≈ I_{flux}(j, T,u)-I_{func}(r,T,u) + I_{src}(f,T)$</span>, see the definition of <a href="#discrete_appr">test function integral contributions</a>.</p><p>The result is a <code>nspec</code> vector giving one value of the integral for each species. </p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L109-L117">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate-Tuple{VoronoiFVM.AbstractSystem, Vector, VoronoiFVM.AbstractTransientSolution}"><a class="docstring-binding" href="#VoronoiFVM.integrate-Tuple{VoronoiFVM.AbstractSystem, Vector, VoronoiFVM.AbstractTransientSolution}"><code>VoronoiFVM.integrate</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">integrate(system,T, U::AbstractTransientSolution; rate=true, params, data)</code></pre><p>Calculate test function integrals for the transient solution   <span>$∫_Γ T \vec j(u^n) ⋅ \vec n dω ≈ I_{flux}(j,T,u^n)-I_{func}(r,T,u^n)-\frac{I_{func}(s,T,u^n)-I_{func}(s,T,u^{n-1})}{t^n-t^{n-1}} + I_{src}(f,T)$</span> for each time interval <span>$(t^{n-1}, t^n)$</span>, see the definition of <a href="#discrete_appr">test function integral contributions</a>.</p><p>Keyword arguments:</p><ul><li><code>params</code>: vector of parameters used to calculate <code>U</code>. Default: <code>[]</code>.</li><li><code>data</code>: user data   used to calculate <code>U</code>. Default: <code>data(system)</code></li><li><code>rate</code>: If <code>rate=true</code> (default), calculate the flow rate (per second)   through the corresponding boundary. Otherwise, calculate the absolute   amount per time interval. </li></ul><p>The result is a <code>nspec x (nsteps-1)</code> DiffEqArray.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L139-L154">source</a></div></details></article><h3 id="Special-purpose-cases"><a class="docs-heading-anchor" href="#Special-purpose-cases">Special purpose cases</a><a id="Special-purpose-cases-1"></a><a class="docs-heading-anchor-permalink" href="#Special-purpose-cases" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate-Union{Tuple{Tv}, Tuple{VoronoiFVM.AbstractSystem, Any, AbstractMatrix{Tv}, AbstractMatrix{Tv}, Any}} where Tv"><a class="docstring-binding" href="#VoronoiFVM.integrate-Union{Tuple{Tv}, Tuple{VoronoiFVM.AbstractSystem, Any, AbstractMatrix{Tv}, AbstractMatrix{Tv}, Any}} where Tv"><code>VoronoiFVM.integrate</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs"> integrate(system, T, U::AbstractMatrix, Uold::AbstractMatrix, Δt; kwargs...)</code></pre><p>Calculate test function integrals for the implicit Euler time step results <span>$u^n≡$</span> <code>U</code> and <span>$u^{n-1}≡$</span> <code>Uold</code> as  <span>$∫_Γ T \vec j(u^n) ⋅ \vec n dω ≈ I_{flux}(j,T,u^n)-I_{func}(r,T,u^n)-\frac{I_{func}(s,T,u^n)-I_{func}(s,T,u^{n-1})}{Δt} + I_{src}(f,T)$</span>, see the definition of <a href="#discrete_appr">test function integral contributions</a>.</p><p>Keyword arguments:</p><ul><li><code>params</code>: vector of parameters used to calculate <code>U</code>. Default: <code>[]</code>.</li><li><code>data</code>: user data   used to calculate <code>U</code>. Default: <code>data(system)</code></li></ul><p>The result is a <code>nspec</code> vector giving one value of the integral for each species. </p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L178-L191">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate_TxFunc"><a class="docstring-binding" href="#VoronoiFVM.integrate_TxFunc"><code>VoronoiFVM.integrate_TxFunc</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">integrate_TxFunc(system, T, f!, U; kwargs...)</code></pre><p>Calculate <span>$I_{func}(f!,T, U)=∫_Ω T⋅ f!(U) dω$</span> for a test function <code>T</code> and unknown vector <code>U</code>.  The function <code>f!</code> shall have the same signature as a storage or reaction function. See the definition of <a href="#discrete_appr">test function integral contributions</a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L213-L219">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate_TxSrc"><a class="docstring-binding" href="#VoronoiFVM.integrate_TxSrc"><code>VoronoiFVM.integrate_TxSrc</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">integrate_TxSrc(system, T, f!; kwargs...)</code></pre><p>Calculate <span>$I_{src}(f!,T)= ∫_Ω T⋅ f! dω$</span> for a test function <code>T.  The function</code>f!` shall have the same signature as a storage or reaction function.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L258-L263">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate_∇TxFlux"><a class="docstring-binding" href="#VoronoiFVM.integrate_∇TxFlux"><code>VoronoiFVM.integrate_∇TxFlux</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">  integrate_∇TxFlux(system, T, f!, U; kwargs...)</code></pre><p>Calculate <span>$I_{flux}(f!,T, U)=∫_Ω ∇T⋅ f!(U) dω$</span> for a test function <code>T</code> and unknown vector <code>U</code>.  The function <code>f!</code> shall have the same signature as a flux function.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L293-L298">source</a></div><div><pre><code class="language-julia hljs">  integrate_∇TxFlux(system, T, U; kwargs...)</code></pre><p>Calculate <span>$I_{flux}(f!,T, U)=∫_Ω ∇T⋅ f!(U) dω$</span> for a test function <code>T</code> and unknown vector <code>U</code>, where <code>flux!</code> is the system flux.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L338-L343">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate_TxEdgefunc"><a class="docstring-binding" href="#VoronoiFVM.integrate_TxEdgefunc"><code>VoronoiFVM.integrate_TxEdgefunc</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">  integrate_TxEdgeFunc(system, T, f!, U; kwargs...)</code></pre><p>Calculate <span>$∫_Ω T⋅ f!(U) dω$</span> for a test function <code>T</code> and unknown vector <code>U</code>.  The function <code>f!</code> shall have the same signature as a flux function, but is assumed to describe a reaction term given on edges.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L346-L352">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate_stdy"><a class="docstring-binding" href="#VoronoiFVM.integrate_stdy"><code>VoronoiFVM.integrate_stdy</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">integrate_stdy(system, T, U; kwargs...)</code></pre><p>Calculate  steady state contribution <span>$I_j(T,u) - I_r(T,u)$</span>  to test function integral   <span>$∫_Γ T \vec j(u) ⋅ \vec n dω$</span> for a given timestep solution. See <a href="#VoronoiFVM.integrate-Union{Tuple{Tv}, Tuple{VoronoiFVM.AbstractSystem, Any, AbstractMatrix{Tv}, AbstractMatrix{Tv}, Any}} where Tv">the time step <code>integrate</code> method</a>.</p><p>Used for impedance calculations.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L389-L397">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate_tran"><a class="docstring-binding" href="#VoronoiFVM.integrate_tran"><code>VoronoiFVM.integrate_tran</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">integrate_tran(system, T, U; kwargs...)</code></pre><p>Calculate  storage term contribution to test function integral. Used for impedance calculations.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_testfunctions.jl#L413-L417">source</a></div></details></article><h2 id="Nodal-flux-reconstruction"><a class="docs-heading-anchor" href="#Nodal-flux-reconstruction">Nodal flux reconstruction</a><a id="Nodal-flux-reconstruction-1"></a><a class="docs-heading-anchor-permalink" href="#Nodal-flux-reconstruction" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM.nodeflux"><a class="docstring-binding" href="#VoronoiFVM.nodeflux"><code>VoronoiFVM.nodeflux</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">nodeflux(system, F,U; data)</code></pre><p>Reconstruction of an edge function as  vector function  on the nodes  of the triangulation.  The result  can be seen as a  piecewiesw linear vector function in the FEM space spanned by the discretization nodes exhibiting the flux density.</p><p>The reconstruction is based on the  &quot;magic formula&quot; R. Eymard, T. Gallouët, R. Herbin, IMA Journal of Numerical Analysis (2006) 26, 326−353, Lemma 2.4  (also: <a href="https://hal.science/hal-00004840">hal.science/hal-00004840</a> ).</p><p>The return value is a <code>dim x nspec x nnodes</code> vector.</p><p>CAVEAT: there is a possible unsolved problem with the values at domain corners in the code. Please see any potential boundary artifacts as a manifestation of this issue and report them.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L149-L166">source</a></div><div><pre><code class="language-julia hljs">nodeflux(system, U; data)</code></pre><p>Reconstruction of the edge flux as vector function  on the nodes  of the triangulation. See <a href="#VoronoiFVM.nodeflux"><code>nodeflux(system,F,U;data)</code></a>.</p><p>The flux of species i can  e.g. plotted via GridVisualize.vectorplot.</p><p>Example:</p><pre><code class="language-julia hljs">    ispec=3
    vis=GridVisualizer(Plotter=Plotter)
    scalarplot!(vis,grid,solution[ispec,:],clear=true,colormap=:summer)
    vectorplot!(vis,grid,nf[:,ispec,:],clear=false)
    reveal(vis)</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_postprocess.jl#L221-L240">source</a></div></details></article><h2 id="Impedance-calculatiom"><a class="docs-heading-anchor" href="#Impedance-calculatiom">Impedance calculatiom</a><a id="Impedance-calculatiom-1"></a><a class="docs-heading-anchor-permalink" href="#Impedance-calculatiom" title="Permalink"></a></h2><p>Impedance calculation can be seen as a postprocessing step after the solution of the unexcited stationary system.</p><article><details class="docstring" open="true"><summary id="VoronoiFVM.AbstractImpedanceSystem"><a class="docstring-binding" href="#VoronoiFVM.AbstractImpedanceSystem"><code>VoronoiFVM.AbstractImpedanceSystem</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">abstract type AbstractImpedanceSystem{Tv&lt;:Number}</code></pre><p>Abstract type for impedance system.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_impedance.jl#L1">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.ImpedanceSystem"><a class="docstring-binding" href="#VoronoiFVM.ImpedanceSystem"><code>VoronoiFVM.ImpedanceSystem</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">mutable struct ImpedanceSystem{Tv} &lt;: VoronoiFVM.AbstractImpedanceSystem{Tv}</code></pre><p>Concrete type for impedance system.</p><ul><li><code>sysnzval::AbstractArray{Complex{Tv}, 1} where Tv</code>: Nonzero pattern of time domain system matrix</li></ul><ul><li><code>storderiv::AbstractMatrix</code>: Derivative of storage term</li></ul><ul><li><code>matrix::AbstractArray{Complex{Tv}, 2} where Tv</code>: Complex matrix of impedance system</li></ul><ul><li><code>F::AbstractArray{Complex{Tv}, 2} where Tv</code>: Right hand side of impedance system</li></ul><ul><li><code>U0::AbstractMatrix</code>: Stationary state</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_impedance.jl#L8">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.ImpedanceSystem-Union{Tuple{Ti}, Tuple{Tc}, Tuple{Tv}, Tuple{VoronoiFVM.AbstractSystem{Tv, Tc, Ti}, AbstractMatrix, Any, Any}} where {Tv, Tc, Ti}"><a class="docstring-binding" href="#VoronoiFVM.ImpedanceSystem-Union{Tuple{Ti}, Tuple{Tc}, Tuple{Tv}, Tuple{VoronoiFVM.AbstractSystem{Tv, Tc, Ti}, AbstractMatrix, Any, Any}} where {Tv, Tc, Ti}"><code>VoronoiFVM.ImpedanceSystem</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">ImpedanceSystem(system, U0, excited_spec, excited_bc)
</code></pre><p>Construct impedance system from time domain system <code>sys</code> and steady state solution <code>U0</code> under the assumption of a periodic perturbation of species <code>excited_spec</code> at  boundary <code>excited_bc</code>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_impedance.jl#L155">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.ImpedanceSystem-Union{Tuple{Ti}, Tuple{Tc}, Tuple{Tv}, Tuple{VoronoiFVM.AbstractSystem{Tv, Tc, Ti}, AbstractMatrix}} where {Tv, Tc, Ti}"><a class="docstring-binding" href="#VoronoiFVM.ImpedanceSystem-Union{Tuple{Ti}, Tuple{Tc}, Tuple{Tv}, Tuple{VoronoiFVM.AbstractSystem{Tv, Tc, Ti}, AbstractMatrix}} where {Tv, Tc, Ti}"><code>VoronoiFVM.ImpedanceSystem</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">ImpedanceSystem(system, U0; λ0)
</code></pre><p>Construct impedance system from time domain system <code>sys</code> and steady state solution <code>U0</code></p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_impedance.jl#L44">source</a></div></details></article><article><details class="docstring" open="true"><summary id="CommonSolve.solve!-Union{Tuple{Tv}, Tuple{AbstractArray{Complex{Tv}, 2}, VoronoiFVM.ImpedanceSystem{Tv}, Any}} where Tv"><a class="docstring-binding" href="#CommonSolve.solve!-Union{Tuple{Tv}, Tuple{AbstractArray{Complex{Tv}, 2}, VoronoiFVM.ImpedanceSystem{Tv}, Any}} where Tv"><code>CommonSolve.solve!</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">solve!(UZ, impedance_system, ω)
</code></pre><p>Solve the impedance system for given frequency <code>ω</code>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_impedance.jl#L203">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.freqdomain_impedance-Tuple{VoronoiFVM.ImpedanceSystem, Vararg{Any, 7}}"><a class="docstring-binding" href="#VoronoiFVM.freqdomain_impedance-Tuple{VoronoiFVM.ImpedanceSystem, Vararg{Any, 7}}"><code>VoronoiFVM.freqdomain_impedance</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">freqdomain_impedance(
    impedance_system,
    ω,
    U0,
    excited_spec,
    excited_bc,
    excited_bcval,
    dmeas_stdy,
    dmeas_tran
)
</code></pre><p>Calculate reciprocal value of impedance.</p><ul><li>excited<em>spec,excited</em>bc,excited_bcval are ignored.</li></ul><div class="admonition is-warning" id="Warning-a26a7e3b5bf922bd"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-a26a7e3b5bf922bd" title="Permalink"></a></header><div class="admonition-body"></div></div><p>This is deprecated: use <a href="#VoronoiFVM.impedance-Tuple{VoronoiFVM.ImpedanceSystem, Vararg{Any, 4}}"><code>impedance</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_impedance.jl#L300">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.impedance-Tuple{VoronoiFVM.ImpedanceSystem, Vararg{Any, 4}}"><a class="docstring-binding" href="#VoronoiFVM.impedance-Tuple{VoronoiFVM.ImpedanceSystem, Vararg{Any, 4}}"><code>VoronoiFVM.impedance</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">impedance(impedance_system,ω, U0 ,
          excited_spec, excited_bc, excited_bcval,
           dmeas_stdy,
           dmeas_tran 
           )
    </code></pre><p>Calculate impedance.</p><ul><li>ω:  frequency </li><li>U0: steady state slution</li><li>dmeas_stdy: Derivative of steady state part of measurement functional</li><li>dmeas_tran  Derivative of transient part of the measurement functional</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_impedance.jl#L260-L277">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.measurement_derivative-Tuple{VoronoiFVM.AbstractSystem, Any, Any}"><a class="docstring-binding" href="#VoronoiFVM.measurement_derivative-Tuple{VoronoiFVM.AbstractSystem, Any, Any}"><code>VoronoiFVM.measurement_derivative</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">measurement_derivative(system, measurement_functional, U0)
</code></pre><p>Calculate the derivative of the scalar measurement functional at steady state U0</p><p>Usually, this functional is  a test function integral.  Initially, we assume that its value depends on all unknowns of the system.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_impedance.jl#L234">source</a></div></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.unknowns-Union{Tuple{VoronoiFVM.ImpedanceSystem{Tv}}, Tuple{Tv}} where Tv"><a class="docstring-binding" href="#VoronoiFVM.unknowns-Union{Tuple{VoronoiFVM.ImpedanceSystem{Tv}}, Tuple{Tv}} where Tv"><code>VoronoiFVM.unknowns</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">unknowns(impedance_system)
</code></pre><p>Create a vector of unknowns of the impedance system</p><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/31fbef19892b1df452e90fceedfe5b29b54c2aee/src/vfvm_impedance.jl#L196">source</a></div></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../solver/">« Solvers</a><a class="docs-footer-nextpage" href="../quantities/">Quantities »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Wednesday 19 November 2025 22:53">Wednesday 19 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
