<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internal API · VoronoiFVM.jl</title><meta name="title" content="Internal API · VoronoiFVM.jl"/><meta property="og:title" content="Internal API · VoronoiFVM.jl"/><meta property="twitter:title" content="Internal API · VoronoiFVM.jl"/><meta name="description" content="Documentation for VoronoiFVM.jl."/><meta property="og:description" content="Documentation for VoronoiFVM.jl."/><meta property="twitter:description" content="Documentation for VoronoiFVM.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">VoronoiFVM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../changes/">Changelog</a></li><li><a class="tocitem" href="../method/">The Voronoi finite volume method</a></li><li><span class="tocitem">API Documentation</span><ul><li><a class="tocitem" href="../system/">System</a></li><li><a class="tocitem" href="../physics/">Physics &amp; special functions</a></li><li><a class="tocitem" href="../solutions/">Solution objects</a></li><li><a class="tocitem" href="../solver/">Solvers</a></li><li><a class="tocitem" href="../post/">Postprocessing</a></li><li><a class="tocitem" href="../quantities/">Quantities</a></li><li><a class="tocitem" href="../misc/">Miscellaneous</a></li><li class="is-active"><a class="tocitem" href>Internal API</a><ul class="internal"><li><a class="tocitem" href="#Wrapping-evaluators-for-physics-callbacks"><span>Wrapping evaluators for physics callbacks</span></a></li><li><a class="tocitem" href="#Manipulating-systems"><span>Manipulating systems</span></a></li><li><a class="tocitem" href="#Global-node-and-edge-assembly-loops"><span>Global node and edge assembly loops</span></a></li><li><a class="tocitem" href="#Local-node-and-edge-assembly-loops"><span>Local node and edge assembly loops</span></a></li><li><a class="tocitem" href="#Degree-of-Freedom-management"><span>Degree of Freedom management</span></a></li><li><a class="tocitem" href="#Geometry-data"><span>Geometry data</span></a></li><li><a class="tocitem" href="#Global-assembly-and-helpers"><span>Global assembly &amp; helpers</span></a></li><li><a class="tocitem" href="#Interface-methods-for-VoronoiFVMDiffEq.jl"><span>Interface methods for <code>VoronoiFVMDiffEq.jl</code></span></a></li><li><a class="tocitem" href="#Misc-tools"><span>Misc tools</span></a></li></ul></li><li><a class="tocitem" href="../allindex/">Index</a></li><li><a class="tocitem" href="../extensions/"><code>ExtendableFEMBase</code> Extension</a></li><li><a class="tocitem" href="../devel/">Development hints</a></li></ul></li><li><span class="tocitem">Tutorial Notebooks</span><ul><li><a class="tocitem" href="../notebooks/">About the notebooks</a></li><li><a class="tocitem" href="../plutostatichtml_examples/ode-diffusion1d/">OrdinaryDiffEq.jl nonlinear diffusion</a></li><li><a class="tocitem" href="../plutostatichtml_examples/ode-wave1d/">OrdinaryDiffEq.jl 1D wave equation</a></li><li><a class="tocitem" href="../plutostatichtml_examples/ode-nlstorage1d/">OrdinaryDiffEq.jl changing mass matrix</a></li><li><a class="tocitem" href="../plutostatichtml_examples/heterogeneous-catalysis/">Coupling with Catalyst.jl</a></li><li><a class="tocitem" href="../plutostatichtml_examples/outflow/">Outflow boundary conditions</a></li><li><a class="tocitem" href="../plutostatichtml_examples/flux-reconstruction/">Obtaining vector fields</a></li><li><a class="tocitem" href="../plutostatichtml_examples/interfaces1d/">Internal interfaces (1D)</a></li><li><a class="tocitem" href="../plutostatichtml_examples/problemcase/">A case for caution</a></li><li><a class="tocitem" href="../plutostatichtml_examples/nonlinear-solvers/">Nonlinear solver control</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../runexamples/">About the examples</a></li><li><a class="tocitem" href="../module_examples/Example101_Laplace1D/">101: 1D Laplace equation</a></li><li><a class="tocitem" href="../module_examples/Example102_StationaryConvectionDiffusion1D/">102: 1D Stationary convection-diffusion equation</a></li><li><a class="tocitem" href="../module_examples/Example103_ConvectionDiffusion1D/">103: 1D Transient convection-diffusion equation</a></li><li><a class="tocitem" href="../module_examples/Example105_NonlinearPoisson1D/">105: 1D Nonlinear Poisson equation</a></li><li><a class="tocitem" href="../module_examples/Example106_NonlinearDiffusion1D/">106: 1D Nonlinear Diffusion equation</a></li><li><a class="tocitem" href="../module_examples/Example107_NonlinearStorage1D/">107: 1D Nonlinear Storage</a></li><li><a class="tocitem" href="../module_examples/Example108_OrdinaryDiffEq1D/">108: 1D Nonlinear Diffusion equation with Rosenbrock method</a></li><li><a class="tocitem" href="../module_examples/Example110_ReactionDiffusion1D_TwoSpecies/">110: 1D Reaction Diffusion equation with two species</a></li><li><a class="tocitem" href="../module_examples/Example115_HeterogeneousCatalysis1D/">115: 1D heterogeneous catalysis</a></li><li><a class="tocitem" href="../module_examples/Example120_ThreeRegions1D/">120: Differing Species Sets in Three Regions, 1D</a></li><li><a class="tocitem" href="../module_examples/Example121_PoissonPointCharge1D/">121: 1D Poisson Equation with Point Charge</a></li><li><a class="tocitem" href="../module_examples/Example125_TestFunctions1D/">125: Terminal Flux Calculation via Test Functions, 1D</a></li><li><a class="tocitem" href="../module_examples/Example150_Impedance1D/">150: Impedance calculation</a></li><li><a class="tocitem" href="../module_examples/Example151_Impedance1D/">151: Impedance calculation</a></li><li><a class="tocitem" href="../module_examples/Example160_UnipolarDriftDiffusion1D/">160: Unipolar degenerate drift-diffusion</a></li><li><a class="tocitem" href="../module_examples/Example161_BipolarDriftDiffusionCurrent/">161: Bipolar drift-diffusion with different definition of current</a></li><li><a class="tocitem" href="../module_examples/Example201_Laplace2D/">201: 2D Laplace equation</a></li><li><a class="tocitem" href="../module_examples/Example203_CoordinateSystems/">203: Various coordinate systems</a></li><li><a class="tocitem" href="../module_examples/Example204_HagenPoiseuille/">204: 2D Convection in Hagen-Poiseuille flow</a></li><li><a class="tocitem" href="../module_examples/Example205_StagnationPoint/">205: Convection in axisymmetric stagnation point flow</a></li><li><a class="tocitem" href="../module_examples/Example206_JouleHeat/">206: 2D Joule heating</a></li><li><a class="tocitem" href="../module_examples/Example207_NonlinearPoisson2D/">207: 2D Nonlinear Poisson equation</a></li><li><a class="tocitem" href="../module_examples/Example210_NonlinearPoisson2D_Reaction/">210: 2D Nonlinear Poisson with reaction</a></li><li><a class="tocitem" href="../module_examples/Example215_NonlinearPoisson2D_BoundaryReaction/">215: 2D Nonlinear Poisson with boundary reaction</a></li><li><a class="tocitem" href="../module_examples/Example220_NonlinearPoisson2D_BoundarySpecies/">220: 2D Nonlinear Poisson with boundary reaction and boundary species</a></li><li><a class="tocitem" href="../module_examples/Example221_EquationBlockPrecon/">221: Equation block preconditioning</a></li><li><a class="tocitem" href="../module_examples/Example225_TestFunctions2D/">225: Terminal flux calculation via test functions, nD</a></li><li><a class="tocitem" href="../module_examples/Example226_BoundaryIntegral/">226: Terminal flux calculation via test functions, nD, boundary reaction</a></li><li><a class="tocitem" href="../module_examples/Example230_BoundaryFlux/">103: Boundary flux</a></li><li><a class="tocitem" href="../module_examples/Example240_FiniteElementVelocities/">240: 2D Convection in quadratic stagnation flow velocity field</a></li><li><a class="tocitem" href="../module_examples/Example301_Laplace3D/">301: 3D Laplace equation</a></li><li><a class="tocitem" href="../module_examples/Example311_HeatEquation_BoundaryDiffusion/">311: Heat Equation with boundary diffusion</a></li><li><a class="tocitem" href="../module_examples/Example405_GenericOperator/">405: Generic operator</a></li><li><a class="tocitem" href="../module_examples/Example406_WeirdReaction/">406: 1D Weird Surface Reaction</a></li><li><a class="tocitem" href="../module_examples/Example410_ManySpecies/">410: Many Species</a></li><li><a class="tocitem" href="../module_examples/Example420_DiscontinuousQuantities/">420: Discontinuous Quantities</a></li><li><a class="tocitem" href="../module_examples/Example421_AbstractQuantities_TestFunctions/">421: Current Calculation for AbstractQuantities</a></li><li><a class="tocitem" href="../module_examples/Example422_InterfaceQuantities/">422: Drift-Diffusion with Discontinuous and Interface Potentials</a></li><li><a class="tocitem" href="../module_examples/Example424_AbstractQuantitiesInit/">424: Initialization of Abstract quantities</a></li><li><a class="tocitem" href="../module_examples/Example430_ParameterDerivativesStationary/">430: Parameter Derivatives (stationary)</a></li><li><a class="tocitem" href="../module_examples/Example435_HigherPrecision/">434: Higher precision</a></li><li><a class="tocitem" href="../module_examples/Example440_ParallelState/">440: Parallel solves</a></li></ul></li><li><span class="tocitem">Development Examples</span><ul><li><a class="tocitem" href="../module_examples/DevEx002_EdgeReaction/">002: check edge reaction</a></li><li><a class="tocitem" href="../module_examples/DevEx003_Solvers/">003: New linear solver API</a></li><li><a class="tocitem" href="../module_examples/DevEx004_EquationBlock3D/">004: 3D Nonlinear Reaction-Diffusion System with Coupled Species</a></li><li><a class="tocitem" href="../module_examples/DevEx005_Mixture/">005: Mixture</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Documentation</a></li><li class="is-active"><a href>Internal API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internal API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/master/docs/src/internal.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Internal-API"><a class="docs-heading-anchor" href="#Internal-API">Internal API</a><a id="Internal-API-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-API" title="Permalink"></a></h1><p>Besides of the interface methods for <code>VoronoiFVMDiffEq</code>,  these are not exported and therefore should not be used outside of the package</p><h2 id="Wrapping-evaluators-for-physics-callbacks"><a class="docs-heading-anchor" href="#Wrapping-evaluators-for-physics-callbacks">Wrapping evaluators for physics callbacks</a><a id="Wrapping-evaluators-for-physics-callbacks-1"></a><a class="docs-heading-anchor-permalink" href="#Wrapping-evaluators-for-physics-callbacks" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM.hasoutflow"><a class="docstring-binding" href="#VoronoiFVM.hasoutflow"><code>VoronoiFVM.hasoutflow</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">hasoutflow(physics)
</code></pre><p>Check if physics object has outflow callback</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L260">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.AbstractEvaluator"><a class="docstring-binding" href="#VoronoiFVM.AbstractEvaluator"><code>VoronoiFVM.AbstractEvaluator</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractEvaluator</code></pre><p>Abstract type for evaluator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L296-L300">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.ResEvaluator"><a class="docstring-binding" href="#VoronoiFVM.ResEvaluator"><code>VoronoiFVM.ResEvaluator</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct ResEvaluator{Tv&lt;:Number, Func&lt;:Function, G} &lt;: VoronoiFVM.AbstractEvaluator</code></pre><p>Evaluator for functions from physics. Allows to call different types of physic functions (flux, reaction, source) an provides  a common interface to different function formats (with data, without data etc.)</p><ul><li><p><code>fwrap::Function</code>:  wrapper function in Format ready for Diffetential equations</p></li><li><p><code>y::Vector{Tv} where Tv&lt;:Number</code>:  pre-allocated result</p></li><li><p><code>geom::Any</code>:  Geometry object # geometry (node, edge...)</p></li><li><p><code>nspec::Int64</code>:  number of species</p></li><li><p><code>isnontrivial::Bool</code>:  Is the function not nofunc</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L303-L310">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.ResEvaluator-Union{Tuple{Tv}, Tuple{Any, Any, Symbol, Vector{Tv}, Any, Int64}} where Tv"><a class="docstring-binding" href="#VoronoiFVM.ResEvaluator-Union{Tuple{Tv}, Tuple{Any, Any, Symbol, Vector{Tv}, Any, Int64}} where Tv"><code>VoronoiFVM.ResEvaluator</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> ResEvaluator(physics,symb,uproto,geom,nspec)</code></pre><p>Constructor for ResEvaluator</p><ul><li><code>physics</code> Physics object</li><li><code>symb</code>: symbol naming one of the functions in physics to be wrapped.</li><li><code>uproto</code>: solution vector prototype,</li><li><code>geom</code>: node, edge...</li><li><code>nspec</code>: number of species</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L325-L334">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.evaluate!-Tuple{VoronoiFVM.ResEvaluator}"><a class="docstring-binding" href="#VoronoiFVM.evaluate!-Tuple{VoronoiFVM.ResEvaluator}"><code>VoronoiFVM.evaluate!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">evaluate!(e::VoronoiFVM.ResEvaluator)
</code></pre><p>Call function in evaluator, store result in predefined memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L369">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.evaluate!-Tuple{VoronoiFVM.ResEvaluator, Any}"><a class="docstring-binding" href="#VoronoiFVM.evaluate!-Tuple{VoronoiFVM.ResEvaluator, Any}"><code>VoronoiFVM.evaluate!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">evaluate!(e::VoronoiFVM.ResEvaluator, u)
</code></pre><p>Call function in evaluator, store result in predefined memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L359">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.res-Tuple{VoronoiFVM.ResEvaluator}"><a class="docstring-binding" href="#VoronoiFVM.res-Tuple{VoronoiFVM.ResEvaluator}"><code>VoronoiFVM.res</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">res(
    e::VoronoiFVM.ResEvaluator
) -&gt; Vector{Tv} where Tv&lt;:Number
</code></pre><p>Retrieve evaluation result</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L379">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.ResJacEvaluator"><a class="docstring-binding" href="#VoronoiFVM.ResJacEvaluator"><code>VoronoiFVM.ResJacEvaluator</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct ResJacEvaluator{Tv&lt;:Number, Func&lt;:Function, Cfg, Res, G} &lt;: VoronoiFVM.AbstractEvaluator</code></pre><p>Evaluator for functions from physics and their Jacobians. Allows to call different types of physic functions (flux, reaction, source) an provides  a common interface to different function formats (with data, without data etc.)</p><ul><li><p><code>fwrap::Function</code>:  wrapper function in Format ready for Differential equations</p></li><li><p><code>config::Any</code>:  ForwardDiff.JacobianConfig</p></li><li><p><code>result::Any</code>:  DiffResults.JacobianResult</p></li><li><p><code>y::Vector{Tv} where Tv&lt;:Number</code>:  pre-allocated result</p></li><li><p><code>geom::Any</code>:  Geometry object # geometry (node, edge...)</p></li><li><p><code>nspec::Int64</code>:  number of species</p></li><li><p><code>isnontrivial::Bool</code>:  Is the function not nofunc</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L386-L393">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.ResJacEvaluator-Union{Tuple{Tv}, Tuple{Any, Any, Symbol, Vector{Tv}, Any, Int64}} where Tv"><a class="docstring-binding" href="#VoronoiFVM.ResJacEvaluator-Union{Tuple{Tv}, Tuple{Any, Any, Symbol, Vector{Tv}, Any, Int64}} where Tv"><code>VoronoiFVM.ResJacEvaluator</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">ResJacEvaluator(physics, data, symb, uproto, geom, nspec)
</code></pre><p>Constructor for ResJEvaluator</p><ul><li><code>physics</code> Physics object</li><li><code>symb</code>: symbol naming one of the functions in physics to be wrapped.</li><li><code>uproto</code>: solution vector prototype,</li><li><code>geom</code>: node, edge...</li><li><code>nspec</code>: number of species</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L411-L420">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.evaluate!-Tuple{VoronoiFVM.ResJacEvaluator, Any}"><a class="docstring-binding" href="#VoronoiFVM.evaluate!-Tuple{VoronoiFVM.ResJacEvaluator, Any}"><code>VoronoiFVM.evaluate!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">evaluate!(e::VoronoiFVM.ResJacEvaluator, u)
</code></pre><p>Call function in evaluator, store result and jacobian in predefined memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L442">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.res-Tuple{VoronoiFVM.ResJacEvaluator}"><a class="docstring-binding" href="#VoronoiFVM.res-Tuple{VoronoiFVM.ResJacEvaluator}"><code>VoronoiFVM.res</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">res(e::VoronoiFVM.ResJacEvaluator) -&gt; Any
</code></pre><p>Retrieve evaluation result</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L454">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.jac-Tuple{VoronoiFVM.ResJacEvaluator}"><a class="docstring-binding" href="#VoronoiFVM.jac-Tuple{VoronoiFVM.ResJacEvaluator}"><code>VoronoiFVM.jac</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">jac(e::VoronoiFVM.ResJacEvaluator) -&gt; Any
</code></pre><p>Retrieve Jacobian</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L461">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.isnontrivial"><a class="docstring-binding" href="#VoronoiFVM.isnontrivial"><code>VoronoiFVM.isnontrivial</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">isnontrivial(e::VoronoiFVM.AbstractEvaluator) -&gt; Any
</code></pre><p>Does calling the evaluator giva nontrivial (nonzero) result?</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_physics.jl#L468">source</a></section></details></article><h2 id="Manipulating-systems"><a class="docs-heading-anchor" href="#Manipulating-systems">Manipulating systems</a><a id="Manipulating-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Manipulating-systems" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM.update_grid_cellwise!"><a class="docstring-binding" href="#VoronoiFVM.update_grid_cellwise!"><code>VoronoiFVM.update_grid_cellwise!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">update_grid_cellwise!(system)</code></pre><p>Update cellwise assembly data for new grid</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L633-L637">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.update_grid_edgewise!"><a class="docstring-binding" href="#VoronoiFVM.update_grid_edgewise!"><code>VoronoiFVM.update_grid_edgewise!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">update_grid_edgewise!(system)</code></pre><p>Update edgewise assembly data for new grid</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L684-L688">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.sysmutatelock"><a class="docstring-binding" href="#VoronoiFVM.sysmutatelock"><code>VoronoiFVM.sysmutatelock</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">const sysmutatelock</code></pre><p>Reentrant lock to safeguard mutating methods <a href="#VoronoiFVM._complete!"><code>_complete!</code></a> and <a href="../system/#VoronoiFVM.update_grid!"><code>update_grid!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L517-L521">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM._complete!"><a class="docstring-binding" href="#VoronoiFVM._complete!"><code>VoronoiFVM._complete!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_complete!(system)</code></pre><p>Update grid and compile species information for system. Uses a lock to ensure parallel access.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L524-L529">source</a></section></details></article><h2 id="Global-node-and-edge-assembly-loops"><a class="docs-heading-anchor" href="#Global-node-and-edge-assembly-loops">Global node and edge assembly loops</a><a id="Global-node-and-edge-assembly-loops-1"></a><a class="docs-heading-anchor-permalink" href="#Global-node-and-edge-assembly-loops" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM.AbstractAssemblyData"><a class="docstring-binding" href="#VoronoiFVM.AbstractAssemblyData"><code>VoronoiFVM.AbstractAssemblyData</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractAssemblyData{Tv, Ti}</code></pre><p>Assembly of residual and Jacobian comes in two flavors, cellwise and edgewise assembly loops, see <a href="../system/#VoronoiFVM.System-Tuple{ExtendableGrid}"><code>VoronoiFVM.System(grid;kwargs...)</code></a>. The necessary data for assembly are held in structs which are subtypes of <code>AbstractAssemblyData</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L1-L6">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.CellwiseAssemblyData"><a class="docstring-binding" href="#VoronoiFVM.CellwiseAssemblyData"><code>VoronoiFVM.CellwiseAssemblyData</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct CellwiseAssemblyData{Tv, Ti} &lt;: VoronoiFVM.AbstractAssemblyData{Tv, Ti}</code></pre><p>Data for cellwise assembly.</p><ul><li><code>nodefactors::Matrix</code>:     Precomputed geometry factors for cell nodes.     This is a <code>ncells x nnodes_per_cell</code> full matrix.</li></ul><ul><li><code>edgefactors::Matrix</code>:     Precomputed geometry factors for cell edges     This is a <code>ncells x nedge_per_cell</code> full matrix.</li></ul><ul><li><p><code>pcolor_partitions::Vector</code></p></li><li><p><code>partition_cells::Vector</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L9-L15">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.EdgewiseAssemblyData"><a class="docstring-binding" href="#VoronoiFVM.EdgewiseAssemblyData"><code>VoronoiFVM.EdgewiseAssemblyData</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct EdgewiseAssemblyData{Tv, Ti} &lt;: VoronoiFVM.AbstractAssemblyData{Tv, Ti}</code></pre><ul><li><code>nodefactors::SparseArrays.SparseMatrixCSC{Tv, Ti} where {Tv, Ti}</code>:     Precomputed geometry factors for  nodes.     This is a <code>nnodes x nregions</code> sparse matrix.</li></ul><ul><li><code>edgefactors::SparseArrays.SparseMatrixCSC{Tv, Ti} where {Tv, Ti}</code>: Precomputed geometry factors for  edges     This is a <code>nedges x nregions</code> sparse matrix.</li></ul><ul><li><p><code>pcolor_partitions::Vector</code></p></li><li><p><code>partition_nodes::Vector</code></p></li><li><p><code>partition_edges::Vector</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L33-L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.nodebatch"><a class="docstring-binding" href="#VoronoiFVM.nodebatch"><code>VoronoiFVM.nodebatch</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nodebatch(assemblydata)</code></pre><p>Outer range for node assembly loop. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L67-L71">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.noderange"><a class="docstring-binding" href="#VoronoiFVM.noderange"><code>VoronoiFVM.noderange</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">noderange(assemblydata, i)</code></pre><p>Inner range for node assembly loop. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L74-L78">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.edgebatch"><a class="docstring-binding" href="#VoronoiFVM.edgebatch"><code>VoronoiFVM.edgebatch</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nodebatch(assemblydata)</code></pre><p>Outer range for edge assembly loop. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L81-L85">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.edgerange"><a class="docstring-binding" href="#VoronoiFVM.edgerange"><code>VoronoiFVM.edgerange</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">edgerange(assemblydata, i)</code></pre><p>Inner range for edge assembly loop. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L88-L92">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM._fill!"><a class="docstring-binding" href="#VoronoiFVM._fill!"><code>VoronoiFVM._fill!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_fill!(node, asmdata, inode, icell)
</code></pre><p>Fill node with the help of assemblydata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L121-L125">source</a></section><section><div><pre><code class="language-julia hljs">_fill!(node, asmdata, ibnode, ibface)
</code></pre><p>Fill boundary node with the help of assemblydata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L138-L142">source</a></section><section><div><pre><code class="language-julia hljs">_fill!(edge, asmdata, iedge, icell)
</code></pre><p>Fill edge with the help of assemblydata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L162-L166">source</a></section><section><div><pre><code class="language-julia hljs">_fill!(bedge, asmdata, ibedge, ibface)
</code></pre><p>Fill boundary edge with the help of assemblydata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L191-L195">source</a></section><section><div><pre><code class="language-julia hljs">_fill!(node, asmdata, k, inode)
</code></pre><p>Fill node with the help of assemblydata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L210-L214">source</a></section><section><div><pre><code class="language-julia hljs">_fill!(edge, asmdata, k, iedge)
</code></pre><p>Fill edge with the help of assemblydata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L221-L225">source</a></section></details></article><h2 id="Local-node-and-edge-assembly-loops"><a class="docs-heading-anchor" href="#Local-node-and-edge-assembly-loops">Local node and edge assembly loops</a><a id="Local-node-and-edge-assembly-loops-1"></a><a class="docs-heading-anchor-permalink" href="#Local-node-and-edge-assembly-loops" title="Permalink"></a></h2><p>Local assembly methods organize the assembly of data to those degrees of freedom (dofs) which are defined for a given node or edge. E.g. for an node residual for <code>nspec</code> defined species, only those entries need to be assembled into the global residual vector which correspond to actually defined degrees of freedom. </p><p>Similarly for  <code>nspec x nspec</code> node Jacobian, an for the <code>nparam x nspec</code> parameter derivatives.</p><p>These local assembly methods organize the correct loops and call back to the concrete assembly methods passed to them. These receive global degrees of freedom and the local species numbers to be handled. The callbacks can be used as well for other purposes than assembly</p><article><details class="docstring" open="true"><summary id="VoronoiFVM.assemble_res_jac"><a class="docstring-binding" href="#VoronoiFVM.assemble_res_jac"><code>VoronoiFVM.assemble_res_jac</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">assemble_res_jac(node, system, asm_res, asm_jac, asm_param)
</code></pre><p>Assemble residual and jacobian for node functions. Parameters:</p><ul><li><p><code>system</code>: System to be worked with</p></li><li><p><code>node</code>: node</p></li><li><p><code>asm_jac(idof,jdof,ispec,jspec)</code>: e.g.  assemble entry <code>ispec,jspec</code> of local jacobian into entry <code>idof,jdof</code> of global matrix</p></li><li><p><code>asm_param(idof,ispec,iparam)</code> shall assemble parameter derivatives</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L234">source</a></section><section><div><pre><code class="language-julia hljs">assemble_res_jac(bnode, system, asm_res, asm_jac, asm_param)
</code></pre><p>Assemble residual and jacobian for boundary node functions. See <a href="#VoronoiFVM.assemble_res_jac"><code>assemble_res_jac</code></a> for more explanations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L272">source</a></section><section><div><pre><code class="language-julia hljs">assemble_res_jac(edge, system, asm_res, asm_jac, asm_param)
</code></pre><p>Assemble residual and jacobian for edge (flux) functions. Parameters:</p><ul><li><code>system</code>: System to be worked with</li><li><code>edge</code>: edge</li><li><code>asm_res(idofK,idofL,ispec)</code>: e.g. assemble local ispec to global degrees of freedom in unknowns</li><li><code>asm_jac(idofK,jdofK,idofL,jdofL,ispec,jspec)</code>: e.g.  assemble entry <code>ispec,jspec</code> of local jacobian into entry four entries defined by <code>idofK</code> and <code>idofL</code> of global matrix</li><li><code>asm_param(idofK,idofL,ispec,iparam)</code> shall assemble parameter derivatives</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L339">source</a></section><section><div><pre><code class="language-julia hljs">assemble_res_jac(bedge, system, asm_res, asm_jac, asm_param)
</code></pre><p>Assemble residual and jacobian for boundary edge (flux) functions. See <a href="#VoronoiFVM.assemble_res_jac"><code>assemble_res_jac</code></a> for more explanations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L407">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.assemble_res"><a class="docstring-binding" href="#VoronoiFVM.assemble_res"><code>VoronoiFVM.assemble_res</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">assemble_res(node, system, asm_res)
</code></pre><p>Assemble residual for node functions. See <a href="#VoronoiFVM.assemble_res_jac"><code>assemble_res_jac</code></a> for more explanations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L304">source</a></section><section><div><pre><code class="language-julia hljs">assemble_res(bnode, system, asm_res)
</code></pre><p>Assemble residual for boundary node functions. See <a href="#VoronoiFVM.assemble_res_jac"><code>assemble_res_jac</code></a> for more explanations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L322">source</a></section><section><div><pre><code class="language-julia hljs">assemble_res(edge, system, asm_res)
</code></pre><p>Assemble residual for edge (flux) functions. See <a href="#VoronoiFVM.assemble_res_jac"><code>assemble_res_jac</code></a> for more explanations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L384">source</a></section><section><div><pre><code class="language-julia hljs">assemble_res(bedge, system, asm_res)
</code></pre><p>Assemble residual for boundary edge (flux) functions. See <a href="#VoronoiFVM.assemble_res_jac"><code>assemble_res_jac</code></a> for more explanations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assemblydata.jl#L447">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.check_allocs"><a class="docstring-binding" href="#VoronoiFVM.check_allocs"><code>VoronoiFVM.check_allocs</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">check_allocs()</code></pre><p>Should allocations be checked ?</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/VoronoiFVM.jl#L64-L68">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.check_allocs!"><a class="docstring-binding" href="#VoronoiFVM.check_allocs!"><code>VoronoiFVM.check_allocs!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">check_allocs!(bool)</code></pre><p>Control allocation checks.  To be used in CI due to https://github.com/JuliaLang/julia/issues/58634</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/VoronoiFVM.jl#L74-L79">source</a></section></details></article><h2 id="Degree-of-Freedom-management"><a class="docs-heading-anchor" href="#Degree-of-Freedom-management">Degree of Freedom management</a><a id="Degree-of-Freedom-management-1"></a><a class="docs-heading-anchor-permalink" href="#Degree-of-Freedom-management" title="Permalink"></a></h2><p>We distinguish</p><ul><li>active degrees of freedom: these are the actual degrees of freedom </li><li>degrees of freedom (dof)  potential degrees of freedom - the may be active dofs or dummy ones With sparse arrays there are no dummy ones, with dense arrays dummy are maske in the node_dof field</li><li>species: each degree of freedom has associated the species it represents and the node index where it is localized  </li></ul><article><details class="docstring" open="true"><summary id="VoronoiFVM.isnodespecies"><a class="docstring-binding" href="#VoronoiFVM.isnodespecies"><code>VoronoiFVM.isnodespecies</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">isnodespecies(system, ispec, inode)
</code></pre><p>Check if species is defined in node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L759">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.isregionspecies"><a class="docstring-binding" href="#VoronoiFVM.isregionspecies"><code>VoronoiFVM.isregionspecies</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">isregionspecies(system, ispec, ireg)
</code></pre><p>Check if species is defined in region.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L772-L776">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.firstnodedof"><a class="docstring-binding" href="#VoronoiFVM.firstnodedof"><code>VoronoiFVM.firstnodedof</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">firstnodedof(system, inode)</code></pre><p>Get first degree of freedom associated with node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L786-L790">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.lastnodedof"><a class="docstring-binding" href="#VoronoiFVM.lastnodedof"><code>VoronoiFVM.lastnodedof</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">lastnodedof(system, inode)</code></pre><p>Get last  degree of freedom associated with node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L793-L797">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.getspecies"><a class="docstring-binding" href="#VoronoiFVM.getspecies"><code>VoronoiFVM.getspecies</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">getspecies(system,idof)</code></pre><p>Get species associated to degree of freedom</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L800-L804">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.getnodedof"><a class="docstring-binding" href="#VoronoiFVM.getnodedof"><code>VoronoiFVM.getnodedof</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">getnodedof(system,ispec,inode)</code></pre><p>Get active or dummy degree of freedom associated with node and species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L779-L783">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.increase_num_species!"><a class="docstring-binding" href="#VoronoiFVM.increase_num_species!"><code>VoronoiFVM.increase_num_species!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> increase_num_species!(system,maxspec)</code></pre><p>Increase number of species in system to maxspec by adding new rows to all  relevant matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L365-L370">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.addzrows"><a class="docstring-binding" href="#VoronoiFVM.addzrows"><code>VoronoiFVM.addzrows</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">addzrows(matrix,maxrow)</code></pre><p>Return matrix with number of rows increased to maxrow, and set the new elements to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_system.jl#L337-L342">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.dofs"><a class="docstring-binding" href="#VoronoiFVM.dofs"><code>VoronoiFVM.dofs</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">dofs(a)
</code></pre><p>Vector of degrees of freedom in solution array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_densesolution.jl#L63">source</a></section><section><div><pre><code class="language-julia hljs">dofs(a)
</code></pre><p>Vector of degrees of freedom in sparse solution array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_sparsesolution.jl#L54">source</a></section></details></article><h2 id="Geometry-data"><a class="docs-heading-anchor" href="#Geometry-data">Geometry data</a><a id="Geometry-data-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry-data" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM.AbstractGeometryItem"><a class="docstring-binding" href="#VoronoiFVM.AbstractGeometryItem"><code>VoronoiFVM.AbstractGeometryItem</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractGeometryItem{Tc&lt;:Number, Ti&lt;:Integer}</code></pre><p>Abstract type for geometry items (node,bnode,edge, bedge)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/VoronoiFVM.jl#L88-L92">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.AbstractNode"><a class="docstring-binding" href="#VoronoiFVM.AbstractNode"><code>VoronoiFVM.AbstractNode</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractNode{Tc&lt;:Number, Ti&lt;:Integer} &lt;: AbstractGeometryItem{Tc&lt;:Number, Ti&lt;:Integer}</code></pre><p>Abstract type for nodes. </p><p><code>node[idim]</code> gives the the corresponding coordinate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_geometryitems.jl#L29-L35">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.AbstractNodeData"><a class="docstring-binding" href="#VoronoiFVM.AbstractNodeData"><code>VoronoiFVM.AbstractNodeData</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractNodeData{Tv&lt;:Number} &lt;: AbstractArray{Tv&lt;:Number, 1}</code></pre><p>Abstract type for data on nodes. <code>u[ispec]</code> accesses value of species at this node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_geometryitems.jl#L40-L45">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.AbstractEdge"><a class="docstring-binding" href="#VoronoiFVM.AbstractEdge"><code>VoronoiFVM.AbstractEdge</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractEdge{Tv&lt;:Number, Ti&lt;:Integer} &lt;: AbstractGeometryItem{Tv&lt;:Number, Ti&lt;:Integer}</code></pre><p>Abstract type for edges </p><p><code>edge[idim,inode]</code> gives coordinate of node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_geometryitems.jl#L69-L75">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.AbstractEdgeData"><a class="docstring-binding" href="#VoronoiFVM.AbstractEdgeData"><code>VoronoiFVM.AbstractEdgeData</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractEdgeData{Tv&lt;:Number} &lt;: AbstractArray{Tv&lt;:Number, 2}</code></pre><p>Abstract type for data on edges. <code>u[ispec,inode]</code> accesses value of species at corresponding node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_geometryitems.jl#L80-L85">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.outflownode!"><a class="docstring-binding" href="#VoronoiFVM.outflownode!"><code>VoronoiFVM.outflownode!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">outflownode!(edge)</code></pre><p>Set <code>edge.outflownode</code> entry.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_geometryitems.jl#L487-L490">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.NodeUnknowns"><a class="docstring-binding" href="#VoronoiFVM.NodeUnknowns"><code>VoronoiFVM.NodeUnknowns</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct NodeUnknowns{Tv, Tc, Ti} &lt;: VoronoiFVM.AbstractNodeData{Tv}</code></pre><p>Unknown data on node. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_geometryitems.jl#L186-L190">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.NodeRHS"><a class="docstring-binding" href="#VoronoiFVM.NodeRHS"><code>VoronoiFVM.NodeRHS</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct NodeRHS{Tv, Tc, Ti} &lt;: VoronoiFVM.AbstractNodeData{Tv}</code></pre><p>RHS data on node. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_geometryitems.jl#L201-L205">source</a></section></details></article><h2 id="Global-assembly-and-helpers"><a class="docs-heading-anchor" href="#Global-assembly-and-helpers">Global assembly &amp; helpers</a><a id="Global-assembly-and-helpers-1"></a><a class="docs-heading-anchor-permalink" href="#Global-assembly-and-helpers" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM.solve_step!"><a class="docstring-binding" href="#VoronoiFVM.solve_step!"><code>VoronoiFVM.solve_step!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">solve_step!(
    state,
    solution,
    oldsol,
    control,
    time,
    tstep,
    embedparam,
    params
)
</code></pre><p>Solve time step problem. This is the core routine for implicit Euler and stationary solve.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_solver.jl#L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.solve_transient!"><a class="docstring-binding" href="#VoronoiFVM.solve_transient!"><code>VoronoiFVM.solve_transient!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">    solve_transient(inival, system, times; kwargs...)</code></pre><p>Solve transient or embedding problem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_solver.jl#L236-L239">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.eval_and_assemble"><a class="docstring-binding" href="#VoronoiFVM.eval_and_assemble"><code>VoronoiFVM.eval_and_assemble</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">eval_and_assemble(
    system,
    U,
    UOld,
    F,
    matrix,
    generic_matrix,
    dudp,
    time,
    tstep,
    λ,
    data,
    params;
    edge_cutoff
)
</code></pre><p>Main assembly method.</p><p>Evaluate solution with result in right hand side F and  assemble Jacobi matrix into system.matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assembly.jl#L505-L512">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM._eval_and_assemble_generic_operator"><a class="docstring-binding" href="#VoronoiFVM._eval_and_assemble_generic_operator"><code>VoronoiFVM._eval_and_assemble_generic_operator</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Evaluate and assemble jacobian for generic operator part.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assembly.jl#L638-L640">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM._addnz"><a class="docstring-binding" href="#VoronoiFVM._addnz"><code>VoronoiFVM._addnz</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_addnz(matrix, i, j, v, fac)
_addnz(matrix, i, j, v, fac, part)
</code></pre><p>Add value <code>v*fac</code> to matrix if <code>v</code> is nonzero</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assembly.jl#L4">source</a></section><section><div><pre><code class="language-julia hljs">_addnz(matrix, i, j, v, fac)
_addnz(matrix, i, j, v, fac, part)
</code></pre><p>Add value <code>v*fac</code> to matrix if <code>v</code> is nonzero</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_assembly.jl#L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM._add"><a class="docstring-binding" href="#VoronoiFVM._add"><code>VoronoiFVM._add</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_add(U::VoronoiFVM.DenseSolutionArray, idof, val) -&gt; Any
</code></pre><p>Add residual value into global degree of freedom</p><p>(Internal method)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_densesolution.jl#L71">source</a></section><section><div><pre><code class="language-julia hljs">_add(U::VoronoiFVM.SparseSolutionArray, idof, val) -&gt; Any
</code></pre><p>Add residual value into global degree of freedom</p><p>(internal)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_sparsesolution.jl#L170">source</a></section></details></article><h2 id="Interface-methods-for-VoronoiFVMDiffEq.jl"><a class="docs-heading-anchor" href="#Interface-methods-for-VoronoiFVMDiffEq.jl">Interface methods for <code>VoronoiFVMDiffEq.jl</code></a><a id="Interface-methods-for-VoronoiFVMDiffEq.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Interface-methods-for-VoronoiFVMDiffEq.jl" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM._eval_res_jac!"><a class="docstring-binding" href="#VoronoiFVM._eval_res_jac!"><code>VoronoiFVM._eval_res_jac!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_eval_res_jac!(state, u, t)
</code></pre><p>Evaluate functiaon and Jacobian at u if they have not been evaluated before at u. See https://github.com/SciML/DifferentialEquations.jl/issues/521 for discussion of another way to do this.</p><p>Evaluation needs to be done with tstep=Inf, like for a stationary problem, because the ODE solvers handle the time derivative. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_diffeq_interface.jl#L1-L9">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.eval_rhs!"><a class="docstring-binding" href="#VoronoiFVM.eval_rhs!"><code>VoronoiFVM.eval_rhs!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">eval_rhs!(du, u, state, t)
</code></pre><p>Interpret the  discrete problem as an ODE/DAE problem. Provide the  rhs function for <a href="../solver/#SciMLBase.ODEFunction"><code>SciMLBase.ODEFunction</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_diffeq_interface.jl#L25">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.eval_jacobian!"><a class="docstring-binding" href="#VoronoiFVM.eval_jacobian!"><code>VoronoiFVM.eval_jacobian!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">eval_jacobian!(J, u, state, t)
</code></pre><p>Interpret the  discrete problem as an ODE/DAE problem. Provide the  jacobi matrix calculation function for <a href="../solver/#SciMLBase.ODEFunction"><code>SciMLBase.ODEFunction</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_diffeq_interface.jl#L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.mass_matrix"><a class="docstring-binding" href="#VoronoiFVM.mass_matrix"><code>VoronoiFVM.mass_matrix</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mass_matrix(state)
</code></pre><p>Calculate the mass matrix for use with <a href="../solver/#SciMLBase.ODEFunction"><code>SciMLBase.ODEFunction</code></a>. Return a Diagonal matrix if it occurs to be diagonal, otherwise return a SparseMatrixCSC.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_diffeq_interface.jl#L52">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.prepare_diffeq!"><a class="docstring-binding" href="#VoronoiFVM.prepare_diffeq!"><code>VoronoiFVM.prepare_diffeq!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">prepare_diffeq!(state, jacval, tjac)
</code></pre><p>Prepare system for use with VoronoiFVMDiffEq.</p><ul><li><code>jacval</code>: value at which to evaluate jacobian to obtatin prototype</li><li><code>tjac</code>: time moment for jacobian</li></ul><p>Returns a prototype for the jacobian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_diffeq_interface.jl#L102">source</a></section></details></article><h2 id="Misc-tools"><a class="docs-heading-anchor" href="#Misc-tools">Misc tools</a><a id="Misc-tools-1"></a><a class="docs-heading-anchor-permalink" href="#Misc-tools" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="VoronoiFVM.solutionarray"><a class="docstring-binding" href="#VoronoiFVM.solutionarray"><code>VoronoiFVM.solutionarray</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">solutionarray(a::Matrix)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_densesolution.jl#L24-L26">source</a></section><section><div><pre><code class="language-julia hljs">solutionarray(a::SparseMatrixCSC)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_sparsesolution.jl#L30-L32">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate-Tuple{Type{&lt;:Cartesian2D}, Vararg{Any, 4}}"><a class="docstring-binding" href="#VoronoiFVM.integrate-Tuple{Type{&lt;:Cartesian2D}, Vararg{Any, 4}}"><code>VoronoiFVM.integrate</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">integrate(, coordl, coordr, hnormal, velofunc; kwargs...)
</code></pre><p>This is an internal function to integrate <code>velofunc</code> along the edge <span>$\sigma=\overline{\mathtt{coordl}\,\mathtt{coordr}}$</span> between the <span>$x_K$</span> and <span>$x_L$</span> where <span>$\mathtt{hnormal}=x_K-x_L$</span> using <a href="https://en.wikipedia.org/wiki/Simpson%27s_rule">Simpson&#39;s Rule</a>. To be precise, compute for a cartesian coordinate system: <span>$\int_{\sigma} \mathbf{v} \cdot \mathbf{n} \,\mathrm{ds} \lvert x_K - x_L \rvert / \lvert\sigma\rvert$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_formfactors.jl#L339">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.integrate-Tuple{Type{&lt;:Cylindrical2D}, Vararg{Any, 4}}"><a class="docstring-binding" href="#VoronoiFVM.integrate-Tuple{Type{&lt;:Cylindrical2D}, Vararg{Any, 4}}"><code>VoronoiFVM.integrate</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">integrate(, coordl, coordr, hnormal, velofunc; kwargs...)
</code></pre><p>This is an internal function similar to <code>integrate(::Type{&lt;:Cartesian2D},...)</code>, but computes instead <span>$\int_{\sigma} r \, \mathbf{v} \cdot \mathbf{n} \,\mathrm{ds} \lvert x_K - x_L \rvert / \left ( \lvert\sigma\rvert r(\mathrm{mid}(\sigma)) \right )$</span> where <span>$r(\mathrm{mid}(\sigma))$</span> is the <span>$r$</span>-coordinate of the mid-point of <span>$\sigma$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_formfactors.jl#L358">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.doolittle_ludecomp!"><a class="docstring-binding" href="#VoronoiFVM.doolittle_ludecomp!"><code>VoronoiFVM.doolittle_ludecomp!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">doolittle_ludecomp!(LU)
</code></pre><p>Non-pivoting inplace LU factorization using Doolittle&#39;s method. Adapted from https://en.wikipedia.org/wiki/LU<em>decomposition#MATLAB</em>code_example.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_functions.jl#L92-L97">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.doolittle_lusolve!"><a class="docstring-binding" href="#VoronoiFVM.doolittle_lusolve!"><code>VoronoiFVM.doolittle_lusolve!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">doolittle_lusolve!(LU, b)
</code></pre><p>Non-pivoting inplace  upper and lower triangular solve of matrix factorized with <code>doolittle_ludecomp!</code>. Adapted from https://en.wikipedia.org/wiki/LU<em>decomposition#MATLAB</em>code_example.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_functions.jl#L116">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM.bernoulli_horner"><a class="docstring-binding" href="#VoronoiFVM.bernoulli_horner"><code>VoronoiFVM.bernoulli_horner</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">bernoulli_horner(x)
</code></pre><p>Calculation of Bernoulli function via Horner scheme based on Taylor coefficients around 0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_functions.jl#L9">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM._warn"><a class="docstring-binding" href="#VoronoiFVM._warn"><code>VoronoiFVM._warn</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_warn(str)</code></pre><p>Warning output, either via @warn or via println. In Pluto notebooks, @warn is always used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_logging_exceptions.jl#L65-L70">source</a></section><section><div><pre><code class="language-julia hljs">  _warn(error, backtrace)</code></pre><p>Print error when catching exceptions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_logging_exceptions.jl#L100-L103">source</a></section></details></article><article><details class="docstring" open="true"><summary id="VoronoiFVM._info"><a class="docstring-binding" href="#VoronoiFVM._info"><code>VoronoiFVM._info</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">_info(str)</code></pre><p>Info output, either via @info or via println.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/VoronoiFVM.jl/blob/7ad71483941f127610f01e5adc2991e61cd126be/src/vfvm_logging_exceptions.jl#L84-L88">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../misc/">« Miscellaneous</a><a class="docs-footer-nextpage" href="../allindex/">Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 15 January 2026 22:56">Thursday 15 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
